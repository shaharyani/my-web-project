<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>עולם 3</title>
        <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
    </head>
    <body>
        {% extends "base.html" %}

{% block head %}
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
{% endblock %}

{% block content %}
<div class="top-section">

    <!-- ===== TOP CARDS ===== -->
    <div class="card-row">
        <div class="cardM" onclick="showTitle('ארץ 5', this)">ארץ 5</div>
        <div class="cardM" onclick="showTitle('ארץ 4', this)">ארץ 4</div>
        <div class="cardM" onclick="showTitle('ארץ 3', this)">ארץ 3</div>
        <div class="cardM" onclick="showTitle('ארץ 2', this)">ארץ 2</div>
        <div class="cardM" id="card-1" onclick="showTitle('ארץ 1', this)">ארץ 1</div>
    </div>

    <div id="card-title" class="title-text">עולם 3 > ארץ 1</div>

    <!-- ===== MAIN LAYOUT ===== -->
    <div class="inline-layout">

        <!-- ===== LEFT PANEL ===== -->
        <div class="left-panel">

            <!-- VALUES RECTANGLE -->
            <div class="big-rectangle">
                <div class="values-grid">
                    <div class="value-item black">
                        <div class="label">BLACK</div>
                        <div class="number">42</div>
                    </div>
                    <div class="value-item red">
                        <div class="label">RED</div>
                        <div class="number">18</div>
                    </div>
                    <div class="value-item white">
                        <div class="label">WHITE</div>
                        <div class="number">27</div>
                    </div>
                    <div class="value-item gray">
                        <div class="label">GRAY</div>
                        <div class="number">{{ gray_value }}</div>
                    </div>
                </div>
            </div>

            {% if is_admin %}
            <div class="gray-edit-section">
                <h4>עריכת ערך אפור</h4>
                <div class="gray-edit-controls">
                    <button onclick="saveGray()">שמירה</button>
                    <input type="number" id="grayInput" value="{{ gray_value }}">
                </div>
            </div>
            {% endif %}

        </div>

        <!-- ===== CENTER TABLE ===== -->
        <div class="data-table-card">
    <div class="filter-section">
        <input type="text" placeholder="ערך סינון" id="tableFilter">
        <select id="columnSelect">
            <option value="0">מצב</option>
            <option value="1">קוד אישי</option>
            <option value="2">מספר סידורי</option>
        </select>
        <h3>בחר אפשרות סינון</h3>
    </div>

    <table id="propertyTable">
        <thead>
            <tr>
                <th>תוצאות</th>
                <th>מצב</th>
                <th>קוד אישי</th>
                <th>מספר סידורי</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td class="view-cell">
                    <a href="#" class="view-link" data-serial="SN-00123" data-code="AX3" data-world="עולם 3">
                        <img src="{{ url_for('static', filename='images/eye.png') }}" class="view-icon" alt="view">
                    </a>
                </td>
                <td>RED</td>
                <td>AX3</td>
                <td>SN-00123</td>
            </tr>
            <tr>
                <td class="view-cell">
                    <a href="#" class="view-link" data-serial="SN-00124" data-code="B22" data-world="עולם 3">
                        <img src="{{ url_for('static', filename='images/eye.png') }}" class="view-icon" alt="view">
                    </a>
                </td>
                <td>WHITE</td>
                <td>B22</td>
                <td>SN-00124</td>
            </tr>
            <tr>
                <td class="view-cell">
                    <a href="#" class="view-link" data-serial="SN-00125" data-code="AX9" data-world="עולם 3">
                        <img src="{{ url_for('static', filename='images/eye.png') }}" class="view-icon" alt="view">
                    </a>
                </td>
                <td>BLACK</td>
                <td>AX9</td>
                <td>SN-00125</td>
            </tr>

            <tr>
                <td class="view-cell">
                    <a href="#" class="view-link" data-serial="SN-00126" data-code="AZ9" data-world="עולם 3">
                        <img src="{{ url_for('static', filename='images/eye.png') }}" class="view-icon" alt="view">
                    </a>
                </td>
                <td>BLACK</td>
                <td>AZ9</td>
                <td>SN-00126</td>
            </tr>

            <tr>
                <td class="view-cell">
                    <a href="#" class="view-link" data-serial="SN-00127" data-code="AZ10" data-world="עולם 3">
                        <img src="{{ url_for('static', filename='images/eye.png') }}" class="view-icon" alt="view">
                    </a>
                </td>
                <td>BLACK</td>
                <td>AZ10</td>
                <td>SN-00127</td>
            </tr>

            <tr>
                <td class="view-cell">
                    <a href="#" class="view-link" data-serial="SN-00128" data-code="AZ11" data-world="עולם 3">
                        <img src="{{ url_for('static', filename='images/eye.png') }}" class="view-icon" alt="view">
                    </a>
                </td>
                <td>BLACK</td>
                <td>AZ11</td>
                <td>SN-00128</td>
            </tr>
        </tbody>
    </table>
</div>

        <!-- ===== RIGHT INFO RECTANGLE ===== -->
        <div class="home-side-rectangle">
            <h3>מידע כללי עבור <span id="selected-country">ארץ 1</span></h3>

            <p>
                <span id="selected-country-data"></span>
            </p>

            <h4>תיק 1</h4>
            <p>תיאור של תיק 1</p>
             <img class="icon" src="{{ url_for('static', filename='images/file.png') }}"
                 alt="PDF">
            <img class="icon" src="{{ url_for('static', filename='images/docx.png') }}"
                 alt="WORD">

            <h4>תיק 2</h4>
            <p>תיאור של תיק 2</p>
             <img class="icon" src="{{ url_for('static', filename='images/file.png') }}"
                 alt="PDF">
            <img class="icon" src="{{ url_for('static', filename='images/docx.png') }}"
                 alt="WORD">

            <h4>תיק 3</h4>
            <p>תיאור של תיק 3</p>
             <img class="icon" src="{{ url_for('static', filename='images/xls.png') }}"
                 alt="XLS">

            {% if is_admin %}
                <h5 style=" font-size: 1rem; color: #2575fc; font-family: 'Rubik', sans-serif; text-align: center;">
                    עריכת הפרטים
                </h5>
            {% endif %}
        </div>

    </div>
</div>

<!-- ===== SCRIPT ===== -->
<script>
function showTitle(name, element) {
    document.getElementById('card-title').innerText = "עולם 3 > " + name;
    document.getElementById('selected-country').innerText = name;
    document.getElementById('selected-country-data').innerText = "מידע מידע מידע מידע על " + name;

    const cards = document.querySelectorAll('.card-row .cardM');
    cards.forEach(card => card.classList.remove('selected'));
    element.classList.add('selected');
}

// Filter table
const tableFilterInput = document.getElementById('tableFilter');
const columnSelect = document.getElementById('columnSelect');
const table = document.getElementById('propertyTable');

tableFilterInput.addEventListener('input', filterTable);
columnSelect.addEventListener('change', filterTable);

function filterTable() {
    const input = tableFilterInput.value.toLowerCase().trim();
    const columnIndex = parseInt(columnSelect.value);
    const rows = table.getElementsByTagName('tr');
    for (let i = 1; i < rows.length; i++) {
        const cells = rows[i].getElementsByTagName('td');
        if (!cells[columnIndex]) continue;
        const text = cells[columnIndex].textContent.toLowerCase().trim();
        rows[i].style.display = text.includes(input) ? '' : 'none';
    }
}

function saveGray() {
    const value = document.getElementById("grayInput").value;
    if (value === "" || value < 0) { alert("Invalid value"); return; }
    alert("GRAY value updated");
}

document.querySelectorAll(".view-link").forEach(link => {
    link.addEventListener("click", function(e) {
        e.preventDefault();
        const serial = this.dataset.serial;
        const code = this.dataset.code;
        const world = this.dataset.world; // NEW: from data-world
        const land = document.getElementById('selected-country').innerText; // current land

        // navigate dynamically with all 5 parameters
        window.location.href = `/view-result/${serial}/${code}/${world}/${land}`;
    });
});

// Initialize default selected card
window.addEventListener('DOMContentLoaded', () => {
    const defaultCard = document.getElementById('card-1');
    showTitle('ארץ 1', defaultCard);
});
</script>
{% endblock %}

    </body>
</html>
